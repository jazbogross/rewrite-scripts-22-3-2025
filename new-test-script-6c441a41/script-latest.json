{"ops":[{"insert":"Rewrite Scripts\n\nOverview\nA web app for collaboratively editing scripts. Content is stored in Supabase and edited in a Quill-based rich text editor and is also saved to the users github account.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Tech: React + Vite + TypeScript, React Quill, Supabase (auth, database), shadcn/ui for components.\n\nDevelopment\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Prerequisites: Node 18+, pnpm/npm\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Install and run\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Install: "},{"attributes":{"color":"#ce9178"},"insert":"`npm install`"},{"insert":"\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Dev server: "},{"attributes":{"color":"#ce9178"},"insert":"`npm run dev`"},{"insert":"\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Lint: "},{"attributes":{"color":"#ce9178"},"insert":"`npm run lint`"},{"insert":"\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Build: "},{"attributes":{"color":"#ce9178"},"insert":"`npm run build`"},{"insert":"\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Preview: "},{"attributes":{"color":"#ce9178"},"insert":"`npm run preview`"},{"insert":"\n\nKey Features\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" A user connects to the app by visiting https://colaborative-writing.netlify.app/auth\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" When the user connects with their GitHub account, they can create a script.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Non-admins can submit edits as suggestions; admins see inline highlights and can approve or reject the edits.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Inline review UI: Clickable highlights with a fixed popover for Approve/Reject.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Versioning and GitHub: Admins can save versions and optionally commit the script to GitHub.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Drafts: Non-admins can save personal drafts before submitting as suggestions (this is currently not working)\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Profiles and scripts: Basic profile management and a scripts list with create/rename functionality.\n\nProject Structure Overview\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`components/`"},{"insert":" UI and editor pieces (DeltaTextEditor, toolbar, dialogs, suggestions UI, profile and scripts views).\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`hooks/`"},{"insert":" data fetching and editor/suggestion logic (loader, manager, formatting, submit handlers, script data).\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`services/`"},{"insert":" API calls to Supabase and related composition logic.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`pages/`"},{"insert":" top-level views (Index, Auth, Profile, ScriptEdit).\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`utils/`"},{"insert":" delta conversions, editor types, and save helpers.\n\nHow It Fits Together\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Routing: "},{"attributes":{"color":"#ce9178"},"insert":"`App.tsx`"},{"insert":" registers routes for Auth, Profile, Index, ScriptEdit, etc.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Script editor page: "},{"attributes":{"color":"#ce9178"},"insert":"`pages/ScriptEdit.tsx`"},{"insert":" loads script data and pending suggestion counts, then renders "},{"attributes":{"color":"#ce9178"},"insert":"`components/script/ScriptEditor.tsx`"},{"insert":".\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Editor shell: "},{"attributes":{"color":"#ce9178"},"insert":"`ScriptEditor`"},{"insert":" wraps "},{"attributes":{"color":"#ce9178"},"insert":"`DeltaTextEditor`"},{"insert":" and the Save Version dialog.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Rich text editor: "},{"attributes":{"color":"#ce9178"},"insert":"`components/DeltaTextEditor.tsx`"},{"insert":" wires the Quill editor, toolbar, dialogs, suggestion overlay/controls, and submit handlers.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Supabase integration: All persistence (scripts, suggestions, drafts, versions, profiles) is via "},{"attributes":{"color":"#ce9178"},"insert":"`integrations/supabase/client.ts`"},{"insert":".\n\nCore Flows\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Loading content\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`hooks/useTextEditor.tsx`"},{"insert":" fetches the current script content (or a user draft for non-admins), normalizes it to a Quill Delta, and provides a "},{"attributes":{"color":"#ce9178"},"insert":"`quillRef`"},{"insert":" to control the editor.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Making edits\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Non-admins: Use the editor to change content, then “Suggest Changes”. The app diffs original vs. edited and stores only the Quill delta diff (retain/insert/delete/attributes).\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Admins: Edit directly when there are no pending suggestions; otherwise review suggestions first.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Suggestion lifecycle\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Load: "},{"attributes":{"color":"#ce9178"},"insert":"`hooks/suggestion/useSuggestionLoader.ts`"},{"insert":" fetches pending suggestions and joins usernames.\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Render: "},{"attributes":{"color":"#ce9178"},"insert":"`hooks/suggestion/useSuggestionManager.ts`"},{"insert":" overlays suggestion highlights into Quill and handles click/hover interactions.\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Review: "},{"attributes":{"color":"#ce9178"},"insert":"`components/suggestions/SuggestionPopover.tsx`"},{"insert":" shows details and Approve/Reject actions; "},{"attributes":{"color":"#ce9178"},"insert":"`InlineSuggestionControls`"},{"insert":" offers quick actions.\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Persist: "},{"attributes":{"color":"#ce9178"},"insert":"`services/suggestionService.ts`"},{"insert":" composes diffs onto the "},{"attributes":{"color":"#ce9178"},"insert":"`scripts`"},{"insert":" content for approve, marks status, and updates other pending diffs where needed.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Versioning and GitHub\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`components/editor/SaveVersionDialog.tsx`"},{"insert":" plus "},{"attributes":{"color":"#ce9178"},"insert":"`hooks/script/useGithubIntegration.ts`"},{"insert":" coordinate saving a named version and optional commit.\n\nData Model (Supabase)\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" scripts: Current canonical content for each script (stored as a Quill Delta JSON) plus metadata.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" script_suggestions: Pending/approved/rejected suggestions as Quill delta diffs; includes author and timestamps.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" script_drafts: Per-user draft content for non-admin editing sessions.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" script_versions: Snapshot history of script content.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" profiles: User profile and username lookup for display.\n\nImportant Modules\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Editor composition\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`components/DeltaTextEditor.tsx`"},{"insert":": orchestrates editor content, toolbar ("},{"attributes":{"color":"#ce9178"},"insert":"`EditorToolbar`"},{"insert":"), dialogs ("},{"attributes":{"color":"#ce9178"},"insert":"`EditorDialogs`"},{"insert":"), and suggestion review.\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`components/editor/EditorContent.tsx`"},{"insert":": the React Quill instance and supported formats (including suggestion marks).\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`hooks/editor/useEditorFormat.ts`"},{"insert":": formatting state and handlers for bold/italic/align/direction.\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`hooks/editor/useEditorSubmitHandlers.ts`"},{"insert":": routes actions to save edits, submit suggestions, and save versions.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Suggestions\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`hooks/suggestion/useSuggestionLoader.ts`"},{"insert":": fetches pending suggestions and usernames.\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`hooks/suggestion/useSuggestionManager.ts`"},{"insert":": overlays suggestions, handles clicks/hover, opens popovers, and calls approve/reject.\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`components/suggestions/SuggestionPopover.tsx`"},{"insert":": fixed-position Approve/Reject popover.\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`components/suggestions/InlineSuggestionControls.tsx`"},{"insert":": small inline hover controls (✓/✕).\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`services/suggestionService.ts`"},{"insert":": server interactions for approve/reject and content composition.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Listing and navigation\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" "},{"attributes":{"color":"#ce9178"},"insert":"`pages/Index.tsx`"},{"insert":" lists scripts; "},{"attributes":{"color":"#ce9178"},"insert":"`pages/Profile.tsx`"},{"insert":" manages profile; "},{"attributes":{"color":"#ce9178"},"insert":"`pages/Auth.tsx`"},{"insert":" handles auth; "},{"attributes":{"color":"#ce9178"},"insert":"`pages/ScriptEdit.tsx`"},{"insert":" is the main editor page.\n\nHow Suggestions Are Stored\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Each suggestion is a Quill Delta diff, not a full copy. Typical operations:\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" retain: move the index forward without changing content (optionally includes attribute changes).\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" insert: proposed new text.\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" delete: proposed removal length.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Block-level attributes (align/direction) are highlighted across full lines so admins can review and act on them.\n\nAdmin vs Contributor UX\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Contributor\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Create or open a script, edit in the Quill editor, and click “Suggest Changes”.\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Optionally save a draft without submitting.\n"},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Admin\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" If pending suggestions exist, the editor shows highlights with Approve/Reject controls.\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" Approving composes the diff into "},{"attributes":{"color":"#ce9178"},"insert":"`scripts.content`"},{"insert":" and records a version. Rejecting marks it rejected.\n  "},{"attributes":{"color":"#6796e6"},"insert":"-"},{"insert":" With no pending suggestions, the admin can edit and save changes directly or save a named version; GitHub commit is available if configured.\n\n\n\n\n\n"},{"attributes":{"align":"center"},"insert":"\n"}]}